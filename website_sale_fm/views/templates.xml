<?xml version="1.0" encoding="utf-8"?>
<openerp>
<data>
<template id="better_confirmation" inherit_id="website_sale.confirmation">
  <xpath expr="//div[@class='oe_website_sale_tx_status']" position="after">
      <div class="col-md-3 col-md-offset-1 text-muted" id="right_column">
                  <span t-field="order.company_id.logo_web" t-field-options='{"widget": "image"}' />
                  <div t-field="order.company_id.partner_id" t-field-options='{
                    "widget": "contact",
                    "fields": ["address", "name", "phone", "email","website"]
                    }'/>
      </div>
  </xpath>
</template>
<!-- Add warning on website cart page -->
<template id="payment" inherit_id="website_sale.cart">
    <xpath expr="//h1" position="after">
        <t t-if="not valid">
            <div class="alert alert-danger">
                <strong>Warning!</strong>
                <p>You have ordered products from different shops, please request an unique order for each shop.</p>
            </div>
        </t>
    </xpath>
</template>
<!-- /shop product listing -->
<template id="brand_page" name="Partner shop">
  <t t-call="website.layout">
      <t t-set="additional_title">Shop</t>
      <div id="wrap" class="js_sale">
        <div class="oe_structure"/>
        <div class="container oe_website_sale">
          <div class='row'>
            <div class="hidden" id="products_grid_before"></div>
            <div class="col-md-12" id="products_grid">
              <table width="100%">
                <tbody>
                  <tr t-ignore="true">
                    <td t-foreach="range(0,rows)" t-as="row" t-attf-width="#{100/rows}%"></td>
                  </tr>
                  <tr t-foreach="bins" t-as="tr_product">
                    <t t-foreach="tr_product" t-as="td_product">
                      <t t-if="td_product">
                      <t t-set="product" t-value="td_product['product']"/>
                      <td t-att-colspan="td_product['x'] != 1 and td_product['x']"
                          t-att-rowspan="td_product['y'] != 1 and td_product['y']"
                          t-attf-class="oe_product oe_grid oe-height-#{td_product['y']*2} #{ td_product['class'] }">

                          <div class="oe_product_cart" t-att-data-publish="product.website_published and 'on' or 'off'">

                            <div class="css_options" t-ignore="true" groups="base.group_website_publisher">
                              <div t-attf-class="dropdown js_options" t-att-data-id="product.id">
                                <button class="btn btn-default" t-att-id="'dopprod-%s' % product.id" role="button" data-toggle="dropdown">Options <span class="caret"></span></button>
                                <ul class="dropdown-menu" role="menu" t-att-aria-labelledby="'dopprod-%s' % product.id">
                                  <li class='dropdown-submenu'>
                                    <a tabindex="-1" href="#">Size</a>
                                    <ul class="dropdown-menu" name="size">
                                      <li><a href="#">
                                        <table>
                                          <tr>
                                            <td class="selected"></td>
                                            <td t-att-class="product.website_size_x > 1 and 'selected'"></td>
                                            <td t-att-class="product.website_size_x > 2 and 'selected'"></td>
                                            <td t-att-class="product.website_size_x > 3 and 'selected'"></td>
                                          </tr>
                                          <tr>
                                            <td t-att-class="product.website_size_y > 1 and 'selected'"></td>
                                            <td t-att-class="product.website_size_y > 1 and product.website_size_x > 1 and 'selected'"></td>
                                            <td t-att-class="product.website_size_y > 1 and product.website_size_x > 2 and 'selected'"></td>
                                            <td t-att-class="product.website_size_y > 1 and product.website_size_x > 3 and 'selected'"></td>
                                          </tr>
                                          <tr>
                                            <td t-att-class="product.website_size_y > 2 and 'selected'"></td>
                                            <td t-att-class="product.website_size_y > 2 and product.website_size_x > 1 and 'selected'"></td>
                                            <td t-att-class="product.website_size_y > 2 and product.website_size_x > 2 and 'selected'"></td>
                                            <td t-att-class="product.website_size_y > 2 and product.website_size_x > 3 and 'selected'"></td>
                                          </tr>
                                          <tr>
                                            <td t-att-class="product.website_size_y > 3 and 'selected'"></td>
                                            <td t-att-class="product.website_size_y > 3 and product.website_size_x > 1 and 'selected'"></td>
                                            <td t-att-class="product.website_size_y > 3 and product.website_size_x > 2 and 'selected'"></td>
                                            <td t-att-class="product.website_size_y > 3 and product.website_size_x > 3 and 'selected'"></td>
                                          </tr>
                                        </table>
                                      </a></li>
                                    </ul>
                                  </li>
                                  <li class='dropdown-submenu'>
                                    <a tabindex="-1" href="#">Styles</a>
                                    <ul class="dropdown-menu" name="style">
                                      <t t-foreach="styles" t-as="style">
                                        <li t-att-class="style_in_product(style, product) and 'active' or ''"><a href="#" t-att-data-id="style.id" t-att-data-class="style.html_class"><t t-esc="style.name"/></a></li>
                                      </t>
                                    </ul>
                                  </li>
                                  <li class='dropdown-submenu'>
                                      <a tabindex="-1" href="#">Promote</a>
                                      <ul class="dropdown-menu" name="sequence">
                                          <li><a href="#" class="js_go_to_top">Push to top</a></li>
                                          <li><a href="#" class="js_go_up">Push up</a>
                                          </li>
                                          <li><a href="#" class="js_go_down">Push down</a></li>
                                          <li><a href="#" class="js_go_to_bottom">Push to bottom</a></li>
                                      </ul>
                                  </li>
                                </ul>
                              </div>
                            </div>
                            <t t-set="product_image_big" t-value="td_product['x']+td_product['y'] > 2"/>
                            <t t-call="website_sale.products_item"/>
                          </div>

                      </td>
                      </t>
                      <td t-if="not td_product" class="oe-height-2"/>
                    </t>
                  </tr>
                </tbody>
              </table>
              <t t-if="not bins">
                <div class="text-center text-muted">
                  <h3 class="css_editable_display">No product defined.</h3>
                  <t groups="base.group_website_publisher">
                    <p groups="base.group_sale_manager">Use the <i>'Content'</i> top menu to create a new product.</p>
                  </t>
                </div>
              </t>
            </div>
          </div>
          <div class="products_pager">
              <t t-call="website.pager"/>
          </div>
        </div>
        <div class="oe_structure mb32"/>
      </div>
      <div class="company_info">
          <div class="container">
              <div class="alert alert-info mt16" role="alert" style="background-color:#FAFAFA">
                  <center>
                      <h3><span t-esc="brand.name" /></h3>
                      <h4><span t-field="brand.rml_header1" /></h4>
                      <group col="2">
                          <div>
                              <t t-if="brand.logo_web">    
                                <span t-field="brand.logo_web" t-field-options='{"widget": "image"}' />
                              </t> 
                              <span t-field="brand.description" />
                              <p t-if = "brand.sale_note">
                                  <b>Terms and Conditions:</b>
                                  <span t-field="brand.sale_note" />
                              </p>
                          </div>
                          <div>
                              <div t-field="brand.partner_id" t-field-options='{
                                  "widget": "contact",
                                  "fields": ["address", "phone", "email"]
                              }'/>
                              <p>
                                  <a t-att-href="brand.website" t-if="brand.website">
                                  <span t-field="brand.website" /></a>
                              </p>
                              <p>Please, do not hesitate to contact us if you have any question about ours products.</p>
                              <t t-if = "brand.logo2">   
                                  <span t-field="brand.logo2" t-field-options='{"widget": "image"}' />
                              </t>
                          </div>
                      </group>
                  </center>
              </div> 
-         </div> 
      </div>
  </t>
</template>
    <!-- Page template for displaying Brands -->
    <template id="product_brands" name="Brands">
        <t t-call="website.layout">
            <t t-if="current_country and check=='/country_defined'">
                <div class="page-header products_pager">
                    <h1>Fair Market <a t-att-href="keep('/%s' % (current_country.name))"><t t-esc="current_country.name"/></a>
                        <p>
                            <small>FairCoop Marketplace for The Fair Economy</small>
                        </p>
                    </h1>
                </div>
            </t>
            <t t-set="additional_title">Partners</t>
            <div id="wrap" t-attf-class="wrapper">
                <div class="container products_pager">
                    <div class="row" style="width: 100%;">
                        <form t-att-action="keep('/shops', search=0)" method="get" t-att-class="search_class">
                            <div class="input-group" style="margin-left:40%;">
                                <div class='col-md-6'>
                                    <input type="text" name="search" class="form-control" placeholder="Search..." t-att-value='search'/>
                                </div>
                                <div class='col-md-2'>
                                    <button class="btn btn-primary">Search</button>
                                </div>
                            </div>
                        </form>
                    </div>
                    <section>
                        <t t-if='not check'>
                            <div class="col-md-3 mb32" id="partner_left">
                                <ul id="reseller_countries" class="nav nav-pills nav-stacked mt16">
                                    <li class="nav-header"><h3>Filter by Country</h3></li>
                                    <t t-foreach="countries" t-as="country">
                                        <li t-if="country['country_id']" t-att-class="country['active'] and 'active' or ''">
                                            <a t-attf-href="/shops#{ current_grade and '/grade/%s' % slug(current_grade) or ''}#{country['country_id'][0] and '/country/%s' % country['country_id'][0] or '' }#{ '?' + (search_path or '') + (country['country_id'][0] == 0 and '&amp;country_all=True' or '')}">
                                                <span class="badge pull-right" t-esc="country['country_id_count'] or ''"/>
                                                <t t-esc="country['country_id'][1]"/>
                                            </a>
                                        </li>
                                    </t>
                                </ul>
                             </div>
                        </t>
                        <t t-if='not countries'>
                            <div class="text-center text-muted">
                                <h3 class="css_editable_display">No Countries Found</h3>
                            </div>
                         </t>
                         <t t-if='brand_rec'>
                           <t t-foreach="brand_rec" t-as="o">
<!--                             <t t-if="check">
                               <div class="col-md-3" style="display: inline-block;">
                                 <a t-attf-href="/shop#{check}#{ '/country/%s' % slug(current_country) or '' }/brands?brand=#{o.id}">
                                   <div class='row'>
                                     <img itemprop="image" width="200px" height="200px" class="img" t-attf-src="/website/image/product.brand/#{o.id}/logo#{'?max_width=300&amp;max_height=300'}"/>
                                   </div>
                                   <div class='row' style='text-align:center;'>
                                       <t t-esc='o.name' />
                                   </div>
                                 </a>
                                 <p><t t-esc="o.company_id.partner_id.name"/></p>
                               </div>
                             </t>
-->
                               <div class="col-md-3" style="display: inline-block;">
                                 <a t-att-href="keep('/shop/brands',brand = o.id)">
                                   <div class="row oe_product">
                                     <div t-if="o.discount" class="ribbon2-wrapper">
                                       <img itemprop="image" 
                                            t-attf-src="/website_sale_fm/static/src/img/discount_badge.png"
                                            alt="Discount campaign badge"
                                            style="right: 45px; width: 65px; top: 15px;" />
                                     </div>
                                     <t t-if="o.logo" > 
                                       <img itemprop="image" width="250px" height="250px" 
                                          t-attf-src="/website/image/res.company/#{o.id}/logo#{'?max_width=300&amp;max_height=300'}"
                                          t-att-alt="o.name"/>
                                     </t> 
                                     <t t-if="not o.logo" >
                                         <t t-if="o.logo2" >
                                             <img itemprop="image" width="250px" height="250px" 
                                                  t-attf-src="/website/image/res.company/#{o.id}/logo2#{'?max_width=300&amp;max_height=300'}"
                                                  t-att-alt="o.name"/>
                                         </t>
                                         <t t-if="not o.logo2" >
                                             <img itemprop="image" width="250px" height="250px" 
                                                  t-attf-src="/website_sale_fm/static/description/icon.png"
                                                  t-att-alt="o.name" />
                                         </t>
                                     </t>  
                                   </div>
                                   <div class="row oe-height-2">
                                     <t t-esc="o.name"/> - 
                                     <t t-esc="o.partner_id.country_id.name"/>
                                   </div>
                                 </a>
                               </div>  
                           </t>
                        </t>
                        <t t-if='not brand_rec'>
                          <div class="text-center text-muted">
                            <h3 class="css_editable_display">No Partners Found</h3>
                          </div>
                        </t>
                    </section>
                    <div class="row" style="width: 100%;">
                        <div class="input-group" style="margin-left:40%">
                            <div class="navbar">
                                <t t-call="website.pager">
                                </t>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </t>
    </template>
    <template id="template_country_list" inherit_id="website_sale.products" name="Country list in shop page">
             <xpath expr="//div[@id='products_grid_before']" position="inside">
                     <ul id="reseller_countries" class="nav nav-pills nav-stacked mt16">
                         <li class="nav-header"><h3>Filter by Country</h3></li>
                         <t t-foreach="countries" t-as="country">
                             <li t-if="country['country_id']" t-att-class="country['active'] and 'active' or ''">
                                 <a t-if="not demand" t-attf-href="/shop#{ current_grade and '/grade/%s' % slug(current_grade) or ''}#{country['country_id'][0] and '/country/%s' % country['country_id'][0] or '' }#{ '?' + (search_path or '') + (country['country_id'][0] == 0 and '&amp;country_all=True' or '')}">
                                     <span class="badge pull-right" t-esc="country['country_id_count'] or ''"/>
                                     <t t-esc="country['country_id'][1]"/>
                                 </a>
                                 <a t-if="demand" t-attf-href="/demands#{ current_grade and '/grade/%s' % slug(current_grade) or ''}#{country['country_id'][0] and '/country/%s' % country['country_id'][0] or '' }#{ '?' + (search_path or '') + (country['country_id'][0] == 0 and '&amp;country_all=True' or '')}">
                                     <span class="badge pull-right" t-esc="country['country_id_count'] or ''"/>
                                     <t t-esc="country['country_id'][1]"/>
                                 </a>
                             </li>
                         </t>
                     </ul>
                     <h3 class="nav-header">Filter by Category</h3>
             </xpath>
        </template>
        <template id="custom_product" inherit_id="website_sale.product" name="Custom Product">
             <xpath expr="//p[@t-field='product.description_sale']" position="after">
                <div class="container">
                    <div class="alert alert-info mt16" role="alert" style="background-color:#FAFAFA">
                         <center>
                         <t t-if="product.company_id.logo2" >
                           <span t-field="product.company_id.logo2" t-field-options='{"widget": "image"}' />
                         </t> 
                         <p>This product is offered by</p>
                         <p> <strong><span t-field="product.company_id.name"/></strong></p>
                         <p><span t-field="product.company_id.rml_header1" /></p>
                         <t t-if="product.company_id.logo_web" >
                           <span t-field="product.company_id.logo_web" t-field-options='{"widget": "image"}' />
                         </t>  
                         <p>Please, do not hesitate to contact us if you have any question about the product.</p>
                         <p t-if = "product.company_id.sale_note"><strong>Terms and Conditions:</strong>
                         <span t-field="product.company_id.sale_note" /></p>
                         <div t-field="product.company_id.partner_id" t-field-options='{
                         "widget": "contact",
                         "fields": ["address", "phone", "email"]
                         }'/>
                         <p><a t-att-href="product.company_id.website" t-if="product.company_id.website"><span t-field="product.company_id.website" /></a></p>
                         <p><a class="my_shop_button" t-att-href="url_for('/shop/brands?brand=' + str(product.company_id.id))">         
                              Click here to see all our products
                         </a></p>
                         </center>
                    </div>
                 </div>
             </xpath>
        </template>
        <template id="products_item_default_image" inherit_id="website_sale.products_item" name="Products default image">
            <xpath expr="//div[@class='oe_product_image']" position="replace">
                <div class="oe_product_image">
                    <t t-if="product.image">
                        <a itemprop="url" t-att-href="keep('/shop/product/%s' % slug(product), page=(pager['page']['num'] if pager['page']['num']>1 else None))">
                            <img itemprop="image" class="img img-responsive" t-att-src="website.image_url(product, 'image', None if product_image_big else '300x300')" t-att-alt="product.name"/>
                        </a>
                    </t>
                    <t t-if="not product.image">
                        <a itemprop="url" t-att-href="keep('/shop/product/%s' % slug(product), page=(pager['page']['num'] if pager['page']['num']>1 else None))">
                            <img itemprop="image" class="img img-responsive" t-attf-src="/website_sale_fm/static/description/icon.png" t-att-alt="product.name"/>
                       </a>
                    </t>
               </div>
            </xpath>
        </template>
        <template id="product_cart_default_image" inherit_id="website_sale.cart" name="Product cart default image" >
            <xpath expr="//td[@align='center']" position="replace">
                              <td align="center" t-if="line.product_id.product_tmpl_id">
                                <t t-if="line.product_id.image_small">
                                   <span>
                                       <img itemprop="image" class="img img-responsive" t-att-src="website.image_url(line.product_id, 'image', None if product_image_big else '200x200')" t-att-alt="line.product_id.display_name" style="max-width:33%;"/>
                                   </span>                                
                                </t>
                                <t t-if="not line.product_id.image_small">
                            <img itemprop="image" class="img img-responsive" t-attf-src="/website_sale_fm/static/description/icon.png" t-att-alt="line.product_id.name"/>
                                </t>
                              </td>
            </xpath> 
        </template>
        <template id="cart_right_column" inherit_id="website_sale.cart" name="Cart Right column" >
            <xpath expr="//div[@id='right_column']" position="replace">
              <div class="col-lg-3 col-lg-offset-1 col-sm-3 col-md-3 text-muted" id="right_column">
                  <h4>Policies</h4>
                  <ul class="list-unstyled mb32">
                      <li>&#9745; We can not process orders with products from different partners.</li>
                      <li>&#9745; You need to complete different sales orders for each partner.</li>
                  </ul>
                  <h4>Secure Payment</h4>
                  <ul class="list-unstyled mb32">
                      <li>&#9745; Pay in FairCoin </li>
                      <li>&#9745; 0% fee, only the minimal network fee</li>
                  </ul>
              </div>
            </xpath>  
        </template>
        <template id="validation_product_default_image" inherit_id="website_sale.payment" name="Validation product default image" >
            <xpath expr="//span[@t-field='line.product_id.image_small']" position="replace">
                                <t t-if="line.product_id.image_small">
                                   <span>
                                       <img itemprop="image" class="img img-responsive" t-att-src="website.image_url(line.product_id, 'image', None if product_image_big else '200x200')" t-att-alt="line.product_id.display_name" style="max-width:33%;" />
                                   </span>
                                </t>
                                <t t-if="not line.product_id.image_small">
                                  <span> 
                                    <img itemprop="image" class="img img-responsive" t-attf-src="/website_sale_fm/static/description/icon.png" t-att-alt="line.product_id.name"/>
                                  </span> 
                                </t>
            </xpath>  
        </template>
        <template id="product_item_custom" inherit_id="website_sale.product" name="Product item custom" >
            <xpath expr="//span[@t-field='product.image']" position="replace">
                <t t-if="product.image">
                    <center><span itemprop="image" t-field="product.image" t-field-options='{"widget": "image", "class": "product_detail_img", "alt-field": "name"}'/></center>
                </t>
                <t t-if="not product.image">    
                   <span> 
                       <img itemprop="image" class="img img-responsive" t-attf-src="/website_sale_fm/static/description/icon.png" t-att-alt="product.name"/>
                   </span> 
                </t>
                <div itemprop="description" t-field="product.description" class="oe_structure mt16" id="product_full_description"/>
            </xpath> 
            <xpath expr="//section/div/div/p[@class='text-muted']" position="replace">
                  <!-- after the company description, some data harcoded in website_sale -->
                  <center><p class='text-muted'>Powered by <a href="https://fair.coop">FairCoop</a></p></center>
            </xpath> 
        </template>

</data>
</openerp>
